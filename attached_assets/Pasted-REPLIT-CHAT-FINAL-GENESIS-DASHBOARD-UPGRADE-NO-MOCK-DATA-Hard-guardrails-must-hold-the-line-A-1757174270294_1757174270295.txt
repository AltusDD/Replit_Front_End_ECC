REPLIT CHAT ‚Äî FINAL GENESIS DASHBOARD UPGRADE (NO MOCK DATA)
Hard guardrails (must hold the line)

Absolutely no mock data anywhere (no Math.random, no hardcoded arrays). If data is missing, show a clear empty-state and surface it in QA ‚Äî never synthesize.

Global date format: Mon D, YYYY (e.g., Sep 9, 2025) across all labels, tooltips, and tables.

Theme contrast: Replace any brown/tan surfaces with our approved cool neutrals. Use tokens below only.

Actionability: Every KPI and feed item navigates to a pre-filtered page that answers ‚Äúwhat to do next.‚Äù

No AbortError noise: AbortErrors are expected on unmount; swallow them silently.

Google Maps only for map plots; only map real lat/lng (no jitter/random offsets).

0) Tokens & polish pass (replace brown tint with cool neutrals)

Update: src/styles/tokens.css

:root{
  --altus-black:#0b0e12;
  --altus-gold:#d6b36a;

  /* High-contrast cool neutrals */
  --panel-bg:#171a1f;
  --panel-elev:#1c2026;
  --line:#2a2f36;

  --text:#e8eaf0;
  --text-dim:#a6adbb;

  --good:#2cc38a;
  --warn:#f3c969;
  --bad:#ef5953;
  --neutral:#8b93a3;
}


Update: src/styles/Dashboard.css

Panel cards .ecc-panel: border:1px solid var(--line); border-radius:12px; background:var(--panel-bg); box-shadow:0 8px 24px rgba(0,0,0,.35)

KPI card .ecc-kpi: min-h:96px; padding:16px 18px; label 12px/uppercase/0.06em var(--text-dim); value 24px/600; trend 12px with up/down arrows.

Chart grids and axes: gridlines stroke: var(--line); labels fill: var(--text-dim).

Map container heights: desktop 520px, tablet 440px, mobile 360px.

Skeleton shimmer class for loading (no layout shift).

1) Global formatters (enforce consistency)

Update: src/utils/format.ts

Use only:

fmtDate(iso) ‚Üí Mon D, YYYY

fmtMoney(n) ‚Üí shows $0 for zero; ‚Äî for null/NaN.

fmtPct(n, dp=1) ‚Üí 94.2%

fmtCompact(n) ‚Üí 1.2K, 3.4M (if already present, keep).

Replace any local/inline date/money logic in dashboard components with the above.

2) Network layer and safety

Update: src/utils/net.ts

fetchJSON<T>(url, signal) with { credentials:'include' }.

Helper isAbortError(e): boolean to identify AbortErrors; never log or show them.

3) Live data hook (single source of truth; no synth)

Update: src/features/dashboard/hooks/useDashboardData.ts
Fetch these live endpoints in parallel (AbortController; ignore AbortError):

/api/portfolio/properties

/api/portfolio/units

/api/portfolio/leases

/api/portfolio/tenants

/api/maintenance/workorders

/api/accounting/transactions?last=90d

Derive (light math only):

Occupancy = occupied units / rentable units.

Rent-ready / Vacant = status='vacant' with rent_ready=true.

Collections MTD = sum(receipts type='rent' month-to-date) / sum(billed rent for active leases MTD). Return numerator/denominator in a kpi.collections.debug object for tooltip.

NOI MTD = income ‚Äì expenses MTD (exclude capex if flagged).

Action feed queues:

Delinquents: top 3 balance_cents > 0 (include delinquency_days if available).

Renewals: leases expiring within 45 days.

Hotlist: work orders priority ‚àà {High, Critical} OR age > 7 days.

Map dataset: include only properties with lat and lng. Count the excluded to show a gold ‚ÄúMissing geo: N‚Äù pill (debug drawer lists them when ?debug=1).

Return also qa for auditing:

qa:{
  counts:{properties, units, leases, tenants, workorders, transactions},
  missing:{ geo:number, tenantNames:number, woPriority:number },
  lastUpdated:string
}

4) KPI Ticker (clarity + clickthrough)

Update: src/features/dashboard/components/KpiTicker.tsx

Four cards, each clickable:

Occupancy (donut + vs last month) ‚Üí /portfolio/units?status=occupied

Rent Ready / Vacant (ratio) ‚Üí /portfolio/units?status=vacant&rent_ready=true

Collections (MTD) (sparkline of daily receipts) ‚Üí /accounting?range=mtd&type=rent

Critical WOs (count) ‚Üí /maintenance?priority=high,critical&status=open

Use token colors; ensure values are 24px and legible at a glance.

5) Portfolio Google Map (usable, clustered, dark)

Update: src/features/dashboard/components/PortfolioGoogleMap.tsx

Use @vis.gl/react-google-maps with VITE_GOOGLE_MAPS_API_KEY.

Map height from tokens (see CSS). Fit bounds to visible markers; default to portfolio centroid if none.

Pins:

Green = occupied & current

Yellow = vacant & rent-ready

Orange = vacant & not ready

Red = occupied & delinquent

Clusters: MarkerClusterer with Altus gold ring/dark fill.

InfoWindow: address, status chips, and actions:

View Details ‚Üí /card/property/{id}

Open WOs ‚Üí /maintenance?property_id={id}&status=open

View Tenants ‚Üí /portfolio/tenants?property_id={id}

Missing geo pill: visible only if qa.missing.geo > 0. When ?debug=1, clicking opens a side drawer listing property names missing coordinates.

6) Priority Action Feed (clear CTAs, readable)

Update: src/features/dashboard/components/PriorityActionFeed.tsx

Delinquency Alerts (Top 3): tenant ‚Üí property, balance in red, days overdue; buttons:

Send Reminder ‚Üí /communication?tenant_id={id}&template=late_notice

Start Eviction ‚Üí /legal?tenant_id={id}&action=eviction

Lease Renewals (‚â§45 days): tenant ‚Üí property, expires {fmtDate}; buttons:

Prepare Renewal ‚Üí /leases?expiring=45

Do Not Renew ‚Üí /leases?decision=non_renew

Maintenance Hotlist: property, priority, age (days); button:

Assign Vendor ‚Üí /maintenance?assign=1&workorder_id={id}

Positive empty states (‚ÄúNo delinquent tenants üéâ‚Äù) instead of blank slabs.

7) Financials & Leasing (actionable, not just pretty)

Update: src/features/dashboard/components/FinancialsAndLeasing.tsx

Cash Flow (90d) ‚Äî ComposedChart:

Green bars = Income; Neutral bars = Expenses; Gold line = NOI.

Tooltip includes income, expenses, NOI, and variance vs prior period.

Legend toggles visibility of each series.

Leasing Funnel (30d) ‚Äî horizontal steps:

Leads ‚Üí Tours ‚Üí Applications ‚Üí Approved ‚Üí Signed + conversion % labels.

CTAs: View Vacants ‚Üí /portfolio/units?status=vacant; View Applications ‚Üí /leases?status=pending

Range toggles (30/60/90) with Altus gold underline for active selection.

8) Occupancy by City (scan + drill)

Update: src/features/dashboard/components/OccupancyByCity.tsx

Columns: City, # Properties, Occupied Units, Vacant Units, Occupancy %.

Right-align numerics; gold progress bar track; sortable headers; search filter; show Top 10 with ‚ÄúShow all‚Äù.

Row click deep-links to /portfolio/properties?city={name}.

9) Page assembly & skeletons

Update: src/features/dashboard/pages/DashboardPage.tsx

Responsive Grid:

Row 1: KPI ticker (full).

Row 2: Map (2/3) + Action Feed (1/3).

Row 3: Cash Flow (1/2) + Leasing Funnel (1/2).

Row 4: Occupancy by City (full).

Show skeletons while fetching; never leave big empty voids.

Dev QA overlay toggled by ?debug=1 with qa JSON and a ‚ÄúCopy to clipboard‚Äù button.

10) Deep links must work (verify)

KPI and Feed buttons route with query params that pre-filter their destination pages. Example:

/portfolio/units?status=vacant&rent_ready=true

/maintenance?priority=high,critical&status=open

/accounting?range=mtd&type=rent

11) Acceptance tests (block merge until all PASS)

No mock data (search repo for mock, Math.random, arrays in dashboard files).

Zero console errors/warnings in dev. AbortErrors swallowed.

All dates render as Mon D, YYYY.

KPI clickthroughs open correct filtered pages.

Map shows only real-geo properties; if some are missing, the gold pill count matches qa.missing.geo.

Collections MTD tooltip shows receipts/billed with matching totals in Accounting screen for MTD.

NOI line equals (income ‚Äì expenses) per period; values match Accounting data.

Leasing funnel counts match corresponding filtered views for selected range.

Contrast AA on labels/values verified; no brown/tint surfaces remain.

Responsive: desktop/tablet/mobile without clipping or overlap.

Deliver back:

Screenshots (desktop & mobile),

?debug=1 QA overlay JSON,

A 1-paragraph diff summary per updated file.

Commit message

feat(dashboard): final Genesis upgrade ‚Äî live-data KPIs, clustered Google Map, action feed, cashflow+NOI, leasing funnel, occupancy table; high-contrast tokens; global date format; QA overlay

Why this will fix what you‚Äôre seeing

The tokens remove the muddy/brown tint and raise contrast so content reads at a glance.

The map gets real heights and fitBounds so it doesn‚Äôt collapse or feel generic.

KPIs are bigger, consistent, and clickable with clear next actions.

Charts reflect cash flow drivers (income/expense/NOI) and leasing conversion ‚Äî not just pretty bars.

The QA overlay makes any missing data explicit (geo, priorities, names) so we stop guessing and can chase upstream issues.

Paste this into Replit Chat as-is. If anything in the API doesn‚Äôt match, have it surface the mismatch in qa.missing and show a graceful empty-state ‚Äî but don‚Äôt fabricate values.